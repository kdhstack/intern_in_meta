name: React Build and gh-pages Deploy

on:
  push:
    branches:
      - main # 코드가 안정화된 main 브랜치에 푸시될 때 실행

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    
    # gh-pages 브랜치에 푸시할 권한이 필요합니다.
    permissions:
      contents: write 

    steps:
      - name: 🛑 Checkout Code
        uses: actions/checkout@v4
        
      - name: 🛠️ Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # 프로젝트에 맞는 Node.js 버전 지정
          cache: 'npm'
        
      - name: 📦 Install dependencies
        run: npm install
        
      - name: ⚙️ Build Project
        # React 프로젝트의 빌드 스크립트 실행. 
        # 이 단계에서 './build' 폴더에 배포할 정적 파일이 생성됩니다.
        run: npm run build
        
      - name: 🚀 Deploy to GitHub Pages (gh-pages branch)
        uses: peaceiris/actions-gh-pages@v3
        with:
          # GitHub 토큰을 사용하여 gh-pages 브랜치에 푸시할 권한을 얻습니다.
          # GITHUB_TOKEN은 GitHub Actions에서 자동으로 제공됩니다.
          github_token: ${{ secrets.GITHUB_TOKEN }}
          # 빌드된 정적 파일이 있는 디렉토리를 지정합니다. (Create React App 기본값: build)
          publish_dir: ./build 
          # 배포 메시지 지정 (선택 사항)
          # publish_message: 'Automatic deploy from GitHub Actions'
