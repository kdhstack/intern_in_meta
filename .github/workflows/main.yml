name: CI/CD(Run & Deploy)

on:
  push:
    branches:
      - main 

jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    
    # ğŸ’¡ defaults ì¶”ê°€: ì´ Jobì˜ ëª¨ë“  'run' ëª…ë ¹ì€ ./prj í´ë” ë‚´ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.
    defaults:
      run:
        working-directory: ./prj
        
    permissions:
      contents: write 

    steps:
      - name: ğŸ›‘ Checkout Code
        uses: actions/checkout@v4
        
      - name: ğŸ› ï¸ Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' 
          cache: 'npm' 
          # ğŸ’¡ ì´ì œ './prj' ë‚´ë¶€ì—ì„œ package-lock.jsonì„ ì°¾ê²Œ ë©ë‹ˆë‹¤.
          # cache-dependency-pathë¥¼ ë³„ë„ë¡œ ì§€ì •í•  í•„ìš” ì—†ì´ defaultsë¡œ í•´ê²°ë©ë‹ˆë‹¤.

      - name: ğŸ“¦ Install dependencies
        # './prj' ë‚´ë¶€ì—ì„œ npm install ì‹¤í–‰
        run: npm install 
        
      - name: âš™ï¸ Run Build and Deploy Script
        # './prj' ë‚´ë¶€ì—ì„œ npm run deploy ì‹¤í–‰ (ë¹Œë“œ ë° gh-pages í‘¸ì‹œ)
        run: npm run deploy
